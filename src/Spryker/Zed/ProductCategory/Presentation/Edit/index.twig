{% extends '@ProductCategory/Add/index.twig' %}
{% set submit_title = 'Save' | trans %}
{% set widget_title = 'Category Edit' | trans %}
{% set widget_title = widget_title ~ ': ' ~ currentCategory.name %}

{% block action %}
    {{ parent() }}
    {{ createActionButton('/product-category/add', 'Create Category' | trans) }}
{% endblock %}

{% block content %}

    {{ form_start(form) }}

    {% embed '@Gui/Partials/widget.twig' with { widget_title: 'General' } %}
        {% block widget_content %}

            {{ form_row(form.category_key) }}
            {{ form_row(form.is_active) }}
            {{ form_row(form.is_clickable) }}
            {{ form_row(form.is_in_menu) }}
            {{ form_row(form.fk_parent_category_node) }}
            {{ form_row(form.extra_parents) }}
            {{ form_row(form.id_category_node) }}
            {{ form_row(form.fk_category) }}
            {{ form_row(form.products_to_be_assigned) }}
            {{ form_row(form.products_to_be_de_assigned) }}
            {{ form_row(form.product_order) }}
            {{ form_row(form.product_category_preconfig) }}
            {{ form_row(form._token) }}

        {% endblock %}
    {% endembed %}

    {% embed '@Gui/Partials/widget.twig' with { widget_title: 'Attributes', row_class: 'widget-class', row_id: 'widget-id' } %}
        {% block widget_content %}

            <div class="tabs-container">
                <ul class="nav nav-tabs">
                    {% for locale,localizedAttributes in form.localized_attributes %}
                        {% set activeCss = '' %}
                        {% set invalidCss = '' %}

                        {% if currentLocale == locale %}
                            {% set activeCss =  'active' %}
                        {% endif %}

                        {% if errors.localized_attributes is defined %}
                            {% if locale in errors.localized_attributes|keys %}
                                {% set invalidCss = 'invalid-tab' %}
                            {% endif %}
                        {% endif %}

                        <li class="{{ activeCss }}  {{ invalidCss }}"><a href="#content_{{ locale }}" data-toggle="tab">{{ locale }}</a></li>
                    {% endfor %}
                </ul>

                <div class="tab-content">
                    {% for locale,localizedAttributes in form.localized_attributes %}
                        {% set active = '' %}
                        {% if currentLocale == locale %}
                            {% set active = 'active' %}
                        {% endif %}

                        <div id="content_{{ locale }}" class="tab-pane {{ active }}">
                            <div class="panel-body">
                                {{ form_row(localizedAttributes.name) }}
                                {{ form_row(localizedAttributes.meta_title) }}
                                {{ form_row(localizedAttributes.meta_description) }}
                                {{ form_row(localizedAttributes.meta_keywords) }}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>

        {% endblock %}
    {% endembed %}

    {% if showProducts %}
        {% embed '@Gui/Partials/widget.twig' with { widget_title: 'Products' } %}
            {% block widget_content %}

                <div class="tabs-container">
                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="#tab-1">Select products to assign</a></li>
                        <li class=""><a data-toggle="tab" href="#tab-2" id="assigned-tab-label">Products to be assigned</a></li>
                    </ul>
                    <div class="tab-content">
                        <div id="tab-1" class="tab-pane active">
                            <div class="panel-body">
                                {{ productsTable | raw }}

                                <div class="prcat-select-all">
                                    <a href="#" class="btn btn-primary ">Select All</a>
                                </div>
                            </div>
                        </div>
                        <div id="tab-2" class="tab-pane">
                            <div class="panel-body">
                                <h3>Selected products</h3>
                                <table class="table table-striped table-bordered table-hover gui-table-data" id="selectedProductsTable" data-paging="false">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>SKU</th>
                                        <th>Name</th>
                                        <th>Selected</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <br/>
                <br/>

                <div class="tabs-container">
                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="#tab-11">Products in this category</a></li>
                        <li class=""><a data-toggle="tab" href="#tab-21" id="deassigned-tab-label">Products to be deassigned</a></li>
                    </ul>
                    <div class="tab-content">
                        <div id="tab-11" class="tab-pane active">
                            <div class="panel-body">
                                {{ productCategoriesTable | raw }}

                                <div class="prcat-deselect-all">
                                    <a href="#" class="btn btn-primary ">Deselect All</a>
                                </div>
                            </div>
                        </div>
                        <div id="tab-21" class="tab-pane">
                            <div class="panel-body">
                                <h3>Deselected products</h3>
                                <table class="table table-striped table-bordered table-hover gui-table-data" id="deselectedProductsTable" data-paging="false">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>SKU</th>
                                        <th>Name</th>
                                        <th>Selected</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            {% endblock %}
        {% endembed %}

    {% endif %}

    <input type="submit" class="btn btn-primary" value="{{ submit_title | trans }}"/>
    <br/>
    <br/>


    {{ form_end(form) }}

{% endblock %}


{% block head_css %}
    {{ parent() }}
{% endblock %}


{% block footer_js %}
    {{ parent() }}
    <script src="/assets/js/spryker-zed-productcategory-edit.js"></script>
{% endblock %}
